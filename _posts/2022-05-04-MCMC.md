---
layout: post
title: MCMC
---





推断问题分为**精确推断和近似推断**，而近似推断又分为确定性（VI）和随机（MCMC）两者。本文介绍是MCMC（markov chain & monte carlo），基于采样的随机近似方法。

# 基本定义

## 问题引入

假设我们有以下后验，$p(z\mid x)$，$x$表示可观测数据，$z$表示隐变量。

假设我们需要计算在该后验概率下的$f(x)$的期望$\mathbb E_{z\mid x} [f(z)]=\int p(z\mid x) f(z) dz$，我们可以将其近似为求和的形式$\mathbb E_{z\mid x} [f(z)]\approx\frac 1N \sum f(z_i), \exists z^{(1)},z^{(2)},\cdots, z^{(n)}\sim p(z\mid x)$，这样我们就可以近似求出该期望了。

但是对于大多数后验概率来说，对其采样的难度很大。因此引入下面的方法进行采样。

### 概率分布采样

<img src="https://zihan-blog-pics-embed.oss-cn-beijing.aliyuncs.com/img/%E6%9C%AA%E5%91%BD%E5%90%8D%E7%BB%98%E5%9B%BE.drawio.png" alt="未命名绘图.drawio" style="zoom: 45%;" />

我们可以从简单的均匀分布中采样$\mu\sim U(0,1)$，对于每一个$\mu^{(i)}$，可以求得相应的$x^{(i)}=cdf^{-1} (\mu^{(i)})$

弊端有： 当pdf很复杂的时候，可能求不出cdf

### 拒绝采样

通常引入一个提议分布$q(z)$（proposed distribution）,$\forall z_i, Mq(z_i)\geq p(z_i)$，要保证$M(q(z_i))$处处大于$p(z)$。

